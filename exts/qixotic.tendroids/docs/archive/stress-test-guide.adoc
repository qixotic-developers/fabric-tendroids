= Phase 2 Stress Test Guide
:toc:
:sectnums:

== Overview

The Phase 2 stress test automatically measures performance degradation as Tendroid count increases from 15 to 30 creatures. This helps identify the performance ceiling of the current transform-based architecture before adding expensive features like transparency and physics.

== Test Configuration

**Test Counts:** 15, 20, 25, 30 Tendroids +
**Monitoring Duration:** 10 seconds per count +
**Architecture:** Transform-based (16 segments) +
**Output:** Timestamped log files with FPS statistics

== Running the Test

=== Method 1: UI Button (Recommended)

1. Open Tendroids Composer application
2. Open the "Tendroid Controls" window
3. Click "Run Stress Test (15-30 Tendroids)" button
4. Wait for test to complete (~50 seconds)
5. Check console for results summary
6. Log file saved to `stress_test_results/` directory

=== Method 2: Script Editor

1. Open Omniverse Script Editor (Window > Script Editor)
2. Paste and run:

[source,python]
----
from qixotic.tendroids.test_stress_phase2 import run_stress_test
results = run_stress_test()
----

=== Method 3: Standalone Python

[source,bash]
----
cd C:\Dev\Omniverse\fabric-tendroids\exts\qixotic.tendroids\qixotic\tendroids
python test_stress_phase2.py
----

== Understanding Results

=== Log File Format

----
==================================================================
Tendroids Phase 2 Stress Test Results
==================================================================
Test Date: 2025-11-15 14:30:00
Architecture: Transform-based (16 segments)

------------------------------------------------------------------
Performance Data
------------------------------------------------------------------
Count    Avg FPS    Min FPS    Max FPS    Samples
------------------------------------------------------------------
15       50.23      48.10      52.45      600
20       42.15      39.80      44.20      600
25       35.67      32.50      38.10      600
30       28.92      25.30      31.50      600

------------------------------------------------------------------
Analysis
------------------------------------------------------------------
Baseline (15 Tendroids): 50.23 fps

20 Tendroids: 42.15 fps (-16.1%)
25 Tendroids: 35.67 fps (-29.0%)
30 Tendroids: 28.92 fps (-42.4%)
==================================================================
----

=== Key Metrics

* **Avg FPS:** Mean frame rate over monitoring period
* **Min FPS:** Worst-case performance (identifies stutters)
* **Max FPS:** Best-case performance
* **Degradation %:** Performance loss vs 15 Tendroid baseline

== Interpreting Results

=== Success Criteria

**GOOD** (Proceed to Phase 2B):
* 30 Tendroids â‰¥ 30 fps average
* Minimal stuttering (min fps close to avg)
* Linear degradation curve

**CAUTION** (Optimize before proceeding):
* 30 Tendroids: 25-30 fps average
* Significant stuttering (min fps << avg)
* Non-linear degradation (bottleneck emerging)

**STOP** (Architecture refactor needed):
* 30 Tendroids < 25 fps average
* Severe stuttering or crashes
* Exponential degradation

=== What to Look For

1. **Degradation Pattern**
   - Linear: CPU/GPU scales well
   - Non-linear: Hitting memory/bandwidth limits
   - Exponential: Critical bottleneck found

2. **Min vs Avg FPS Gap**
   - Small gap (<10%): Smooth performance
   - Large gap (>20%): Stuttering issues
   - Huge gap (>50%): Serious stability problems

3. **Breaking Point**
   - At what count does FPS drop below 30?
   - Does performance cliff suddenly or gradually?
   - Can we add transparency/physics overhead?

== Next Steps

After reviewing results:

1. **If performance is good (30+ fps @ 30 Tendroids)**
   - Document headroom for Phase 2B features
   - Proceed to Warp kernel investigation
   - Plan transparency implementation

2. **If performance needs optimization**
   - Profile to find bottlenecks
   - Consider architectural changes
   - Re-evaluate Phase 2 feature scope

3. **Update project documentation**
   - Record maximum Tendroid count
   - Document performance characteristics
   - Set realistic targets for Phase 2B/C

== Technical Notes

=== FPS Monitoring

The test uses `time.perf_counter()` for high-precision timing:

* Sample rate: ~60 Hz (0.016s intervals)
* Statistics calculated from ~600 samples per test
* Minimal overhead from monitoring itself

=== Test Isolation

Each test run:
* Clears previous Tendroids
* Waits 2 seconds for scene to settle
* Monitors for exactly 10 seconds
* Records all samples for statistical analysis

=== Limitations

* UI blocking during test (no async in current implementation)
* No CPU/GPU profiling (add if needed)
* Fixed spawn parameters (could parameterize for advanced testing)

== Customization

To test different configurations, modify `test_stress_phase2.py`:

[source,python]
----
# Custom test counts
results = run_stress_test(
    test_counts=[10, 15, 20, 25, 30, 35, 40],
    monitoring_duration=15.0  # Longer monitoring window
)
----

== Troubleshooting

**Problem:** Test hangs or crashes +
**Solution:** Check console for errors, reduce max count

**Problem:** Inconsistent results +
**Solution:** Close other applications, run multiple times

**Problem:** Log file not created +
**Solution:** Check write permissions on `stress_test_results/` directory

'''

*Last Updated: November 15, 2025* +
*Part of Tendroids Phase 2 Development Plan*
