= Quick Start for GPU Optimization Phase
:date: 2025-11-25

== TL;DR - Start Here

**Working Directory:** `C:\Dev\Omniverse\fabric-tendroids\exts\qixotic.tendroids`

**Current Performance:** 15 tendroids @ 50fps (RTX 4090)

**Goal:** 100+ tendroids @ 60fps using full GPU acceleration

== What's Already GPU-Accelerated

✓ Vertex deformation (Warp kernels in `v2/core/warp_deformer.py`)
✓ Mesh generation (procedural cylinders)

**Result:** 1480 theoretical fps for deformation alone

== What Needs GPU Acceleration

❌ Bubble physics - Python loops in `v2/bubbles/bubble.py`
❌ Transform updates - USD Python API (CPU-bound)
❌ Wave calculations - Python in `v2/animation/wave_controller.py`
❌ Particle systems - Python in `v2/bubbles/pop_particle.py`

== Architecture Entry Points

**Bubble Manager:** `v2/bubbles/bubble_manager.py`
- `_BubbleState.update()` - Main physics loop (TARGET FOR WARP)
- Line ~290: Position/velocity updates

**Wave Controller:** `v2/animation/wave_controller.py`
- `_calculate_wave_effect()` - Per-tendroid wave math (TARGET FOR WARP)
- Line ~180: Wave displacement calculations

**Scene Manager:** `v2/scene/manager.py`
- `_on_update()` - Main update loop
- Orchestrates all systems

== Key Files for Optimization

[cols="1,2"]
|===
|File |What to Optimize

|`v2/bubbles/bubble.py`
|Move `update()` method to Warp kernel

|`v2/bubbles/bubble_manager.py`
|Batch bubble updates, use Fabric for transforms

|`v2/animation/wave_controller.py`
|Batch wave calculations across all tendroids

|`v2/core/warp_tendroid.py`
|Already optimal (keep as reference)

|`v2/scene/manager.py`
|Orchestrate GPU batching
|===

== Available GPU Tools

**Warp:** `/v2/core/warp_deformer.py` shows working example
**Fabric/USDRT:** Docs at https://docs.omniverse.nvidia.com/kit/docs/usdrt.scenegraph/latest/
**CUDA:** Direct GPU programming (if Warp insufficient)

== Performance Baseline

[source]
----
Warp GPU:    0.68ms/frame (1480 fps) ← Already using this
NumPy:       2.55ms/frame (392 fps)
Python:      6.67ms/frame (150 fps) ← Current bubble physics
----

**Target:** Get everything to Warp GPU speed

== Quick Test Command

Stress test for performance verification:

[source,python]
----
# In Script Editor
exec(open(r"C:\Dev\Omniverse\fabric-tendroids\exts\qixotic.tendroids\qixotic\tendroids\tests\test_warp_stress.py").read())
----

== First Optimization Target

**Bubble Physics → Warp Kernel**

Why: Biggest CPU bottleneck, clear Warp kernel pattern available

File: `v2/bubbles/bubble.py`
Method: `V2Bubble.update()`
Lines: ~180-250

Strategy:
1. Create `bubble_physics.py` with Warp kernel
2. Batch all bubble updates in single GPU call
3. Use Warp arrays for positions/velocities
4. Update USD transforms via Fabric

== Read This First

**Full details:** `CONTINUITY-2025-11-25-optimization-ready.adoc` (same directory)
**Warp example:** `v2/core/warp_deformer.py` (working GPU deformation)
**Architecture:** `v2/scene/manager.py` (system orchestration)

== GPU Resources

**RTX 4090 specs:**
- 16,384 CUDA cores
- 24GB VRAM
- PCIe 4.0 x16

**Current utilization:** ~5% (only vertex deformation on GPU)
**Target utilization:** 60-80% (all physics on GPU)
