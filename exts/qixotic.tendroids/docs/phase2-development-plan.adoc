= Phase 2 Development Plan - Advanced Tendroids Features
:toc:
:toclevels: 3
:sectnums:

== Overview

Phase 2 focuses on advanced visual and interactive features while maintaining the 50fps @ 15 Tendroids performance baseline established in Phase 1.

== Pre-Phase 2: Architecture Validation

=== Stress Testing (Priority: CRITICAL)
**Goal:** Find performance ceiling before adding expensive features

**Test Scenarios:**
1. Tendroid count scaling: 15 → 20 → 25 → 30 creatures
2. Monitor FPS degradation curve
3. Identify breaking point for current architecture
4. Document bottlenecks that emerge at scale

**Success Criteria:**
* Know maximum Tendroid count at 30fps minimum
* Identify which systems degrade first
* Validate headroom for transparency/physics features

=== Single-Tendroid Customization Controls
**Goal:** Individual creature parameterization before adding complexity

**Features to Implement:**
* Per-Tendroid diameter control
* Per-Tendroid length control (segment count)
* Per-Tendroid wave timing offset
* Per-Tendroid animation speed multiplier

**Technical Approach:**
* Extend TendroidFactory with parameter passing
* UI controls in spawn_settings_ui.py
* Test with varied population (mix of sizes/speeds)

**Success Criteria:**
* Spawn 15 Tendroids with different parameters
* Maintain 50fps performance
* Validate UI responsiveness

== Phase 2A: GPU Vertex Deformation Investigation

=== Warp Kernel Transition Research
**Goal:** Understand requirements for transform → vertex deformation migration

**Investigation Areas:**
1. **Swept Torus Geometry Requirements**
   * Mathematical model for manifold topology
   * Wall thickness consistency algorithms
   * UV mapping for swept torus
   * Normal calculation for smooth shading

2. **Warp Kernel Architecture**
   * Batch processing for multiple Tendroids
   * Memory layout optimization
   * Kernel launch overhead vs computation time
   * Integration with existing C++ FastMeshUpdater

3. **Breathing Deformation Lookup Functions**
   * Pre-computed breathing curves
   * Interpolation strategies
   * Cache efficiency for repeated access
   * Trade-offs: memory vs computation

**Deliverable:** Technical specification document for Warp transition

**Success Criteria:**
* Clear understanding of performance implications
* Architectural decision: proceed or maintain transforms
* If proceed: detailed implementation plan

== Phase 2B: Transparency Effects

=== Material Safety System Enhancement
**Goal:** Support transparent materials on dynamic Tendroids

**Technical Requirements:**
1. Validate swept torus geometry with glass shader
2. Test material safety detection with transparency
3. Ensure GPU stability during vertex updates
4. Performance impact assessment

**Features:**
* Semi-transparent Tendroid bodies
* Configurable opacity levels
* Gradient transparency (more opaque at base)
* Interaction with underwater lighting

**Performance Target:**
* Maintain 40fps minimum with 15 transparent Tendroids
* Graceful degradation beyond that

**Risk Mitigation:**
* Start with single transparent Tendroid test
* Incremental rollout to avoid GPU crashes
* Fallback to opaque materials if unstable

== Phase 2C: Physics-Based Interactions

=== PhysX Integration Planning
**Goal:** Realistic movement and collision behavior

**Features (Priority Order):**
1. **Buoyancy Simulation**
   * Upward force based on volume
   * Water resistance on movement
   * Natural floating behavior

2. **Collision Detection**
   * Tendroid-to-Tendroid soft body collisions
   * Tendroid-to-sea floor collisions
   * Bounce/slide responses

3. **Environmental Forces**
   * Current flow effects (directional movement)
   * Turbulence variation over time
   * Zone-based force fields

**Technical Challenges:**
* PhysX performance with 15+ soft bodies
* Integration with existing animation system
* Balancing physics realism vs artistic control

**Success Criteria:**
* 30fps minimum with full physics on 10 Tendroids
* Visually believable underwater movement
* No physics-animation conflicts

== Phase 2D: Bubble System

=== Particle Effects Integration
**Goal:** Environmental atmosphere and visual interest

**Features:**
* Rising bubbles from sea floor
* Bubble emission from Tendroid movement
* Configurable bubble density
* Size variation and clustering

**Technical Approach:**
* Leverage existing Omniverse particle systems
* Optimize particle count for performance
* LOD system for distant bubbles

**Performance Budget:**
* Maximum 5fps cost for bubble system
* Target: 1000-2000 active particles
* Adaptive culling based on camera distance

== Phase 2E: Environmental Elements (Flora)

=== Ecosystem Development
**Goal:** Rich underwater environment

**Features (Low Priority):**
* Seaweed/kelp with physics-based sway
* Coral formations (static geometry)
* Rock outcroppings integrated with terrain
* Ambient particle effects (sediment, plankton)

**Technical Considerations:**
* Minimal performance impact (already have sea floor)
* Reuse existing material systems
* Procedural placement using terrain data

== Implementation Strategy

=== Phased Rollout
1. **Validation Phase:** Stress testing + customization (2-3 sessions)
2. **Investigation Phase:** Warp kernel research (2-4 sessions)
3. **Implementation Phase:** One feature at a time, validate performance
4. **Integration Phase:** Combine features, optimize, stabilize

=== Performance Gates
Before proceeding to next feature:
* Current feature must meet performance target
* No regressions in baseline functionality
* Material safety systems remain stable

=== Documentation Requirements
For each phase:
* Technical specification before implementation
* Performance benchmark results
* Lessons learned document
* Updated architecture diagrams

== Decision Points

=== Go/No-Go Criteria

**Warp Kernel Transition:**
* GO if: >2x performance improvement potential
* NO-GO if: <1.5x improvement or high risk

**Transparency:**
* GO if: Swept torus + materials stable in testing
* NO-GO if: GPU crashes or <30fps with 10 Tendroids

**Physics:**
* GO if: PhysX integration clean and performant
* NO-GO if: >10fps cost or animation conflicts

== Success Metrics

=== Phase 2 Complete When:
* ≥3 advanced features implemented and stable
* 30fps minimum with all features enabled (10 Tendroids)
* Material safety systems validated with new features
* Comprehensive documentation of architecture decisions

---
*Next Session: Begin with stress testing current architecture*
